# 21.01.16

## 주요 질문

#### 💡 [트랜잭션 설명해주세요.](#트랜잭션transaction)
   * DB 상태를 변화하는 흐름 단위이며 원자성, 일관성, 고립성, 지속성의 특징을 가지고 있습니다.
   
#### 💡 [로킹기법 설명해주세요](#로킹locking)
   * 트랜잭션이 동시에 여러개가 진행되면 갱신 손실, 연쇄 복귀 등 여러 문제가 발생할 수 있습니다. 로킹기법은 이 문제를 해결하기 위해 트랜잭션에 LOCK을 설정하여 LOCK이 존재하는 경우 트랜잭션이 진행되지 않도록 하는 기법입니다.



<br/>

## ⭐ 개념 정리

### 트랜잭션(Transaction)
   * 데이터베이스의 논리적 작업 단위
   * 특징 (ACID)
      * 원자성 : All or Nothing, 결과가 모두 반영되거나 아무것도 반영되지 않아야 함
      * 일관성 : 트랜잭션 후에도 데이터베이스 상태는 무결성을 유지
      * 고립성 : 한 트랜잭션 중간에 다른 트랜잭션이 끼어들 수 없음
      * 지속성 : 트랜잭션으로 변화된 상태는 계속 유지되어야 함
   * TCL
      * COMMIT : 트랜잭션 성공하여 DB에 상태 반영
      * ROLLBACK  : 트랜잭션 실패하여 기존 상태로 복구
   

<br/>

### 회복
   * 외부/내부 장애로 데이터베이스가 일관성을 유지하지 못할 때 이를 유지하기 위한 방법
   * 회복 연산자
      * REDO : 백업본으로 변경 후, 로그 기록에 남은 성공 데이터를 DB에 적용
      * UNDO : 변경된 데이터를 취소하고 예전 데이터로 복구
   

<br/>

### 동시성 제어
   * 여러 트랜잭션 간의 문제가 발생하지 않도록 트랜잭션의 실행 순서를 제어하는 기법
   
   | |T1|T2|발생문제| 허용여부|
   |---|---|---|---|---|
   |CASE1|READ|READ|X|허용|
   |CASE2|READ|WRITE|오손읽기, 유령데이터 읽기|허용/불가 선택|
   |CASE3|WRITE|WRITE| 갱신손실, 연쇄복구, 모순성| 절대 불가|

<br/>

### 로킹(Locking)
   * 동시성 제어 방법으로 트랜잭션에 LOCK을 설정하여 LOCK 상태에서 다른 트랜잭션이 실행하지 못하도록 하는 기법
   * 2단계 로킹
      * 확장 단계 : LOCK을 걸 수만 있음
      * 축소 단계 : UNLOCK만 가능
   * 문제점 : 데이터가 많은 경우 교착상태에 빠질 수 있음 
<br/>

### 교착상태(DeadLock)
   * 여러 트랜잭션이 실행되지 못하고 무기한 대기 중인 상태
   * 해결 방법
      * 예방기법 : 트랜잭션 시작 전, 필요한 데이터에 LOCK을 모두 걸어주는 기법. 필요한 데이터가 많은 경우 무쓸모
      * 회복기법 : 자원 할당 시에 타임스탬프를 사용하여 시간 순서대로 제어하는 기법.
