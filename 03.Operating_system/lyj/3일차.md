# 운영체제 3일차

## 교착상태와 기아상태

### 교착상태

모든 작업이 각 작업의 락(공유자원을 잡고 있는 상황)이 풀리길 기다리는 상황

### 교착상태 발생조건

- **상호배제** : 공유자원의 사용은 한번에 한 프로세스만 사용가능하다. 여러 프로세스가 접근 할 수 없다.
- **점유대기** : 공유자원에 접근중이 한 프로세스가 접근해제를 하지 않고 다른 자원에 접근하려고 기다린다.
- **비선점** : 한 프로세스가 자원의 사용을 끝낼 때까지 그 자원을 뺏을 수 없다.
- **순환대기** : 각 프로세스는 순환적으로 다음 프로세스가 요구하는 자원을 가지고 있다.

네가지의 조건 중 하나라도 만족하지 않는다면 교착상태는 일어나지 않는다.

```markdown
나한테 남친이 있다 내 친구도 남친이 있어 
갑자기 친구 남친 뺏고 싶어
내 친구가 내 남친도 뺏고 싶어해 
옆에 각자 남친 있으니까 서로 못뻇고 대기하는 상황
```

### 기아상태

병행 프로세스에서 프로세스가 실행되는데에 필수적인 자원을 끊임없이 사용하지 못하는 상황입니다. 

우선순위(Priority) 스케줄링(Scheduling) 알고리즘입니다.

- 스케줄러나 상호배제 알고리즘의 에러로부터 발생
- 자원 누수에 의해 발생
- 서비스 거부 공격에 의해 발생

## 메모리 단편화

메모리 단편화는 메모리 공간이 여러 공간으로 나뉘어져 사용 가능한 메모리가 충분하지만 프로세스에 메모리 할당(사용)이 불가능한 상태

- 내부 단편화

    프로세스가 **필요한 양보다 더 큰 메모리**가 할당되어 **메모리 공간이 낭비**되는 것을 말합니다. 

- 외부 단편화

    메모리 할당 및 해제 작업이 진행될 때 메모리 공간은 충분하지만 **중간에 사용하지 않는 메모리**가 있어 프로세스에 공간 할당을 못한 것입니다.

## 프레임과 페이지

### 프레임

**물리 메모리**를 일정 크기의 블록으로 나눈 단위를 말합니다.

### 페이지

 보조기억장치를 이용하여 **가상 메모리**를 일정 크기의 블록으로 나눈 단위를 말합니다.

## Paging과 Segmentation

### **페이징(Paging)**

페이징은 **사용하지 않는 프레임을 페이지에 옮기고** **필요한 메모리를 페이지 단위로 프레임에 옮기는** 기법입니다

```markdown
프레임 → 페이지 : 사용하지 않는 프레임을!
페이지 → 프레임 : 메모리를 필요할 때!
```

**Page Table**을 이용하여 프레임과 페이징을 연결하는 **Page Mapping**을 진행합니다. 

페이징 기법을 사용하게되면 **연속적이지 않은 공간도 연속적으로 활용할 수 있기 때문에 위의 외부 단편화 문제점을 해결**할 수 있습니다. **페이지 단위를 작게 하면 내부 단편화 문제도 해결**할 수 있습니다. 

하지만 그만큼 Mapping 과정 또한 늘어나기 때문에 Trade-Off 가 발생할 수 있습니다. 그리고 보통 페이지 단위에 알맞게 꽉채워 쓰는게 아니므로 내부 단편화 문제는 여전히 있습니다.

### 세그멘테이션(Segmentation)

가상 메모리를 서로 크기가 다른 세그멘트(Segment)를 논리적 단위로 분할해 사용하는 기법입니다.

세그먼트 테이블이 존재하는데, 이 세그먼트 테이블에는 세그먼트 번호, 시작주소, 세그먼트 크기가 들어있습니다.

프로세서가 세그먼트 테이블에 **테이블 번호, 사용할 메모리 크기**를 전달하면, 세그먼트 테이블에서 물리 메모리로 가서 해당 테이블 번호의 base(시작주소) 와 limit(세그먼트 크기) 를 비교하여 limit보다 메모리 공간이 작으면 인터럽트를 발생시켜 해당 프로세스를 강제 종료합니다.

![%E1%84%8B%E1%85%AE%E1%86%AB%E1%84%8B%E1%85%A7%E1%86%BC%E1%84%8E%E1%85%A6%E1%84%8C%E1%85%A6%203%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1%205e76f0a9021f4467b6dc03b1be947159/Untitled.png](%E1%84%8B%E1%85%AE%E1%86%AB%E1%84%8B%E1%85%A7%E1%86%BC%E1%84%8E%E1%85%A6%E1%84%8C%E1%85%A6%203%E1%84%8B%E1%85%B5%E1%86%AF%E1%84%8E%E1%85%A1%205e76f0a9021f4467b6dc03b1be947159/Untitled.png)